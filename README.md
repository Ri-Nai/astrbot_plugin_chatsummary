# AstrBot 聊天记录总结插件

一个基于 LLM 的历史聊天记录总结插件，支持按数量和时间范围总结群聊消息。

## 功能特性

- ✨ 支持按消息数量总结（如：最近 100 条消息）
- ⏰ 支持按时间范围总结（如：最近 1 小时的消息）
- 🤖 基于 LLM 智能分析和总结聊天内容
- 💬 支持群聊和私聊两种使用场景
- 🎯 自动过滤机器人自身消息

## 使用方法

### 群聊场景

在群聊中使用 `/消息总结` 命令：

```
/消息总结 100        # 总结最近 100 条消息
/消息总结 1h         # 总结最近 1 小时的消息
/消息总结 30m        # 总结最近 30 分钟的消息
/消息总结 2d         # 总结最近 2 天的消息
```

### 私聊场景

在私聊中使用 `/群总结` 命令（需要指定群号）：

```
/群总结 100 123456789    # 总结指定群最近 100 条消息
/群总结 1h 123456789     # 总结指定群最近 1 小时的消息
```

## 时间格式说明

支持的时间单位：
- `m` - 分钟（minutes）
- `h` - 小时（hours）
- `d` - 天（days）

示例：
- `30m` = 30 分钟
- `2h` = 2 小时
- `1d` = 1 天

## 配置说明

插件配置文件位于 `data/config/astrbot_plugin_chatsummary_config.json`，支持为每个群组单独配置：

### 配置示例

```json
{
  "group1": {
    "id": "123456789",
    "summary_prompt": "请你作为一个专业的社群聊天记录总结分析师...",
    "scheduled_summary": {
      "enabled": true,
      "schedule_time": "22:00",
      "interval": "24h"
    }
  },
  "group2": {
    "id": "987654321",
    "summary_prompt": "请简要总结以下聊天记录的核心内容：",
    "scheduled_summary": {
      "enabled": false,
      "schedule_time": "21:00",
      "interval": "12h"
    }
  }
}
```

### 配置项说明

- **id**: 群号（必填）
- **summary_prompt**: 该群组专用的 LLM 提示词（可选，默认使用通用提示词）
- **scheduled_summary**: 定时总结配置
  - **enabled**: 是否启用定时总结（true/false）
  - **schedule_time**: 每天发送总结的时间（HH:MM 格式，如 "22:00"）
  - **interval**: 总结的时间范围（如 "24h" 表示总结过去 24 小时的消息）

### 定时总结功能

插件支持为每个群组独立配置定时总结：
- 每天在指定时间自动发送总结
- 可自定义总结的时间范围
- 支持多个群组不同的发送时间
- 每个群组可使用不同的提示词风格

## 安装

1. 将插件放置到 AstrBot 的插件目录
2. 重启 AstrBot 或重载插件
3. 配置 LLM 相关参数（如需要）

## 版本信息

- **当前版本**: v1.3.0
- **作者**: Ri-Nai
- **仓库**: [GitHub](https://github.com/Ri-Nai/astrbot_plugin_chatsummary)

## 依赖

- AstrBot 核心框架
- LLM 服务（通过 AstrBot 的 LLM 接口）

## 许可证

本项目遵循开源许可协议。

## 贡献

欢迎提交 Issue 和 Pull Request！

---

**注意**: 使用本插件需要确保 AstrBot 已正确配置 LLM 服务。
